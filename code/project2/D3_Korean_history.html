<!DOCTYPE html>
<html>
	<head>
		<title>
			The Wild Wild East: Crazy Korean History
		</title>
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<style type="text/css">
			/* put things here */
			g{
				pointer-events: all;
			}
			.cool_svg{
				background-color : #ccc;
			}
			.cool_axis path{
				stroke: none;
			}
			.cool_text{
				font-size:11px;
				font-family:verdana;
			}
			.cool_text_dom{
				font-size:10px;
				font-family:verdana;
			}

			.cool_rect_life{
			    -webkit-transition: fill .2s; /* Safari */
			            transition: fill .2s;
				fill: turquoise;
			}
			.cool_rect_reign{
			    -webkit-transition: fill .2s; /* Safari */
			            transition: fill .2s;
				fill: #558;
			}
			.cool_rect_life.selected{
			    -webkit-transition: fill .2s; /* Safari */
			            transition: fill .2s;
				fill : #faa;
			}
			.cool_rect_reign.selected{
			    -webkit-transition: fill .2s; /* Safari */
			            transition: fill .2s;
				fill : #f33;
			}

		</style>
	</head>
	<body>
		<div id="Korean_kingdom_chart"></div>

		<script type="text/javascript">
			// d3.select("#Korean_kingdom_chart").html("Jim\u00e9nez")

			// 1. data
			var Korean_kingdom_data = [{"name":"Gojoseon","Explanation":"First Korean nation","Preceded by":"","Year of foundation":-2333,"Year of fall":-108,"Succeeded by":"Buyeo, Mahan confederacy","Fall":"Perished by Han dynasty of China","Age":"Ancient"},{"name":"Jin state","Explanation":"Second Korean nation","Preceded by":"","Year of foundation":-400,"Year of fall":-200,"Succeeded by":"Mahan confederacy, Byeonhan confederacy, Jinhan confederacy","Fall":"Divied into three Hans of Mahan, Byeonhan, Jinhan","Age":"Ancient"},{"name":"Buyeo","Explanation":"Northern trace of Gojoseon","Preceded by":"Gojoseon","Year of foundation":-200,"Year of fall":494,"Succeeded by":"Goguryeo, Baekje","Fall":"Conquered by Goguryeo","Age":"Proto\u2013Three Kingdoms"},{"name":"Goguryeo","Explanation":"One of the Three Kingdoms","Preceded by":"Buyeo","Year of foundation":-37,"Year of fall":668,"Succeeded by":"Silla, Balhae","Fall":"Perished by Silla, Tang dynasty of China","Age":"Proto\u2013Three Kingdoms, Three Kingdoms"},{"name":"Ogjeo","Explanation":"Known for by its interesting marriage custom","Preceded by":"Buyeo","Year of foundation":-200,"Year of fall":244,"Succeeded by":"Goguryeo","Fall":"Amalgamated to Goguryeo","Age":"Proto\u2013Three Kingdoms"},{"name":"Dong Ye","Explanation":"The actual name is East Ye, \"dong\" means \"east\"","Preceded by":"Buyeo","Year of foundation":-200,"Year of fall":244,"Succeeded by":"Goguryeo","Fall":"Amalgamated to Goguryeo","Age":"Proto\u2013Three Kingdoms"},{"name":"Mahan confederacy","Explanation":"Confederacy of 54 city states, southern trace of Gojoseon","Preceded by":"Jin state","Year of foundation":-200,"Year of fall":300,"Succeeded by":"Baekje","Fall":"Conquered by Baekje","Age":"Proto\u2013Three Kingdoms"},{"name":"Byeonhan confederacy","Explanation":"Confederacy of 12 city states","Preceded by":"Jin state","Year of foundation":-200,"Year of fall":42,"Succeeded by":"Gaya confederacy","Fall":"Succeeded by Gaya confederacy","Age":"Proto\u2013Three Kingdoms"},{"name":"Jinhan confederacy","Explanation":"Confederacy of 12 city states","Preceded by":"Jin state","Year of foundation":-200,"Year of fall":-57,"Succeeded by":"Silla","Fall":"Conquered by Silla","Age":"Proto\u2013Three Kingdoms"},{"name":"Baekje","Explanation":"One of the Three Kingdoms","Preceded by":"Mahan confederacy","Year of foundation":-18,"Year of fall":660,"Succeeded by":"Silla","Fall":"Perished by Silla, Tang dynasty of China","Age":"Three Kingdoms"},{"name":"Gaya confederacy","Explanation":"Confederacy of 6 Iron Kingdoms","Preceded by":"Byeonhan confederacy","Year of foundation":42,"Year of fall":562,"Succeeded by":"Baekje, Silla","Fall":"Conquered by Silla, Baekje","Age":"Three Kingdoms"},{"name":"Silla","Explanation":"One of the Three Kingdoms","Preceded by":"Jinhan confederacy","Year of foundation":-57,"Year of fall":935,"Succeeded by":"Goryeo","Fall":"Conquered by Goryeo","Age":"Three Kingdoms, North\u2013South States, Later Three Kingdoms"},{"name":"Usan state","Explanation":"Island kingdom of Ulleungdo","Preceded by":"Ogjeo, Dong Ye","Year of foundation":244,"Year of fall":930,"Succeeded by":"Goryeo","Fall":"Vassal state of Silla; absorbed into Goryeo","Age":"Three Kingdoms, North\u2013South States, Later Three Kingdoms, Unitary dynastic period"},{"name":"Tamna","Explanation":"Island kingdom of Jeju Island","Preceded by":"","Year of foundation":300,"Year of fall":1105,"Succeeded by":"Goryeo","Fall":"Vassal state of Baekje, Silla; absorbed into Goryeo","Age":"Three Kingdoms, North\u2013South States, Later Three Kingdoms, Unitary dynastic period"},{"name":"Balhae","Explanation":"Revival of Goguryeo","Preceded by":"Goguryeo","Year of foundation":698,"Year of fall":926,"Succeeded by":"Goryeo","Fall":"Perished by Liao dynasty of northen China; absorbed into by Goryeo","Age":"North\u2013South States"},{"name":"Later Goguryeo","Explanation":"Kingdom of the Monk King Gung Ye","Preceded by":"Silla","Year of foundation":901,"Year of fall":918,"Succeeded by":"Goryeo","Fall":"Succeeded by to Goryeo","Age":"Later Three Kingdoms"},{"name":"Later Baekje","Explanation":"Kingdom founded by and fallen to Gyeon Hwon","Preceded by":"Baekje, Silla","Year of foundation":892,"Year of fall":936,"Succeeded by":"Goryeo","Fall":"Conquered by Goryeo","Age":"Later Three Kingdoms"},{"name":"Goryeo","Explanation":"First United Kingdom of Korea","Preceded by":"Later Goguryeo, Silla, Balhae","Year of foundation":918,"Year of fall":1392,"Succeeded by":"Joseon","Fall":"Succeeded by Joseon","Age":"Unitary dynastic period"}];
			// console.log(Korean_kingdom_data);

			// 2. dimensions

			// 3. scales
			var Korean_kingdom_yscale = d3.scaleLinear()
				.domain([-2400,1500]) // need to lengthen it
				.range([-2500,1600])
			;
			var Korean_kingdom_yaxis = d3.axisLeft()
				.scale(Korean_kingdom_yscale)
			;


			// 4. svg
			var Korean_kingdom_svg = d3.select("#Korean_kingdom_chart").append("svg")
				.attr("height", 500)
				.attr("width", 3000)
				.attr("class", "cool_svg")
			;

			// 5. axes
			var Korean_kingdom_yaxis_in_chart = Korean_kingdom_svg.append("g")
				.attr("transform", "translate(50, 0)")
				.attr("class", "cool_axis")
				.call(Korean_kingdom_yaxis)
			;

			// 6. life rect
			var Korean_kingdom_life_rect = Korean_kingdom_svg.append("g")
				.selectAll("rect").data(Korean_kingdom_data).enter().append("rect")
				.attr("height", 10)
				.attr("width", function( d, i ){ 
					if(d["Year of fall"]){
						return 1000+Korean_kingdom_yscale(d["Year of fall"]-d["Year of foundation"]);
					}
					else{
						return 1000+Korean_kingdom_yscale(2017-d["Year of foundation"]);
					}
				} )
				.attr("y", function( d, i ){ return 50 + i*15; } )
				.attr("x", function( d, i ){ return Korean_kingdom_yscale(d["Year of foundation"]); } )
				.attr("class", function( d, i ){ return "cool_rect_"+i+" cool_rect_life"; } )
			;
			// // 7. reign rect
			// var Korean_kingdom_reign_rect = Korean_kingdom_svg.append("g")
			// 	.selectAll("rect").data(Korean_kingdom_data).enter().append("rect")
			// 	.attr("height", 10)
			// 	.attr("width", function( d, i ){
			// 		var height = 1000+Korean_kingdom_yscale(d["Year of Reign end"]-d["Year of Reign begin"]);
			// 		if(0 <= height){
			// 			return height;
			// 		}
			// 		else{
			// 			console.log(d);
			// 			return 0;
			// 		}
			// 	} )
			// 	.attr("y", function( d, i ){ return 50 + i*15; } )
			// 	.attr("x", function( d, i ){ return Korean_kingdom_yscale(d["Year of Reign begin"]); } )
			// 	.attr("class", function( d, i ){ return "cool_rect_"+i+" cool_rect_reign"; } )
			;
			// 8. invisible mouse action rect
			var Korean_kingdom_invisible_rect = Korean_kingdom_svg.append("g")
				.selectAll("rect").data(Korean_kingdom_data).enter().append("rect")
				.attr("height", 10)
				.attr("width", function( d, i ){ 
					if(d["Year of fall"]){
						return 1000+Korean_kingdom_yscale(d["Year of fall"]-d["Year of foundation"]);
					}
					else{
						return 1000+Korean_kingdom_yscale(2017-d["Year of foundation"]);
					}
				} )
				.attr("y", function( d, i ){ return 50 + i*15; } )
				.attr("x", function( d, i ){ return Korean_kingdom_yscale(d["Year of foundation"]); } )
				.attr("class", function( d, i ){ return "cool_rect_"+i; } )
				.attr("fill", "none")
			;
			Korean_kingdom_invisible_rect
		        // .on('mouseover', tip.show)
		        .on("mouseover", function() {
		        	var this_class = d3.select(this).attr("class");
					d3.selectAll("."+this_class)
						.classed("selected", true);
				})
		        // .on('mouseout', tip.hide)
		        .on('mouseout', function() {
		        	d3.select(this)
						.classed("selected", false);

					var this_class = d3.select(this).attr("class");
					d3.selectAll("."+this_class)
						.classed("selected", false);
				})
			;




			// 8. kings name
			var Korean_kingdom_name_text = Korean_kingdom_svg.append("g")
				.selectAll("text").data(Korean_kingdom_data).enter().append("text")
				.attr("transform", function( d, i ){ 
					// var y = 50 + i*15; 
					// var x = 10 + Korean_kingdom_yscale(d["Year of death"]);
					// return "rotate(90,"+y+","+x+")";
				} )
				// .text("name of Kings")
				// .text(function( d, i ){ return "name of Kings"; })
				.text(function( d, i ){ return d["name"].toUpperCase(); })
				// .attr("x", 10)
				// .attr("y", 10)
				.attr("y", function( d, i ){ return 50 + i*15; } )
				.attr("x", function( d, i ){ return 1000 + Korean_kingdom_yscale(d["Year of fall"]); } )
				.attr("class", "cool_text")
			;

			// var 

			// var tip = d3.tip()
			// 	.attr('class', 'd3-tip')
			// 	.offset([-10, 0])
			// 	.html(function(d) {
			// 		return "<strong>Frequency:</strong> <span style='color:red'>" + d.frequency + "</span>";
			// 	})

			// Korean_kingdom_svg.call(tip);

		 //    // Korean_kingdom_svg.selectAll(".bar")
   //    // 			.data(Korean_kingdom_data)
   //  		// 	.enter().append("rect")
   //    // 			.attr("class", "bar")
   //    // 			.attr("x", function(d) { return x(d.letter); })
   //   	// 		.attr("width", x.rangeBand())
		 //    //     .attr("y", function(d) { return y(d.frequency); })
		 //    //     .attr("height", function(d) { return height - y(d.frequency); })
		 //    Korean_kingdom_life_rect

			// group these and make them show up when selected

			// // name
			// var Korean_kingdom_king_name_text = Korean_kingdom_svg.append("g")
			// 	.selectAll("text").data(Korean_kingdom_data).enter().append("text")
			// 	.text(function( d, i ){ return d["name"].toUpperCase(); })
			// 	.attr("x", function( d, i ){ return 65 + i*15; } )
			// 	.attr("y", function( d, i ){ return 30 + Korean_kingdom_yscale(d["Year of birth"]); } )
			// 	.attr("class", "cool_text")

			// // year of birth
			// var Korean_kingdom_year_birth_text = Korean_kingdom_svg.append("g")
			// 	.selectAll("text").data(Korean_kingdom_data).enter().append("text")
			// 	.text(function( d, i ){ return "Year of Birth: " + d["Year of birth"]; })
			// 	.attr("x", function( d, i ){ return 50 + i*15; } )
			// 	.attr("y", function( d, i ){ return 10 + Korean_kingdom_yscale(d["Year of birth"]); } )
			// 	.attr("class", "cool_text_dom")
			// ;

			// year of death

			// year of Reign began

			// Year of Reign end

			// // 9. kingdom
			// var Korean_kingdom_kingdom_text = Korean_kingdom_svg.append("g")
			// 	.selectAll("text").data(Korean_kingdom_data).enter().append("text")
			// 	.text(function( d, i ){ return d["Kingdom"]; })
			// 	.attr("x", function( d, i ){ return 65 + i*15; } )
			// 	.attr("y", function( d, i ){ return 30 + Korean_kingdom_yscale(d["Year of birth"]); } )
			// 	.attr("class", "cool_text_dom")
			// ;

			// // 10. house
			// var Korean_kingdom_house_text = Korean_kingdom_svg.append("g")
			// 	.selectAll("text").data(Korean_kingdom_data).enter().append("text")
			// 	.text(function( d, i ){ return d["House"]; })
			// 	.attr("x", function( d, i ){ return 65 + i*15; } )
			// 	.attr("y", function( d, i ){ return 40 + Korean_kingdom_yscale(d["Year of birth"]); } )
			// 	.attr("class", "cool_text_dom")
			// ;

			// // 11. family(relation with the previous kings)
			// var Korean_kingdom_family_text = Korean_kingdom_svg.append("g")
			// 	.selectAll("text").data(Korean_kingdom_data).enter().append("text")
			// 	.text(function( d, i ){ return d["Family"]; })
			// 	.attr("x", function( d, i ){ return 65 + i*15; } )
			// 	.attr("y", function( d, i ){ return 50 + Korean_kingdom_yscale(d["Year of birth"]); } )
			// 	.attr("class", "cool_text_dom")
			// ;

		</script>
	</body>
</html>
